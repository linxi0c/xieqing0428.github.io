<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>听泉.ღ</title>
  
  <subtitle>— 听泉小窝 —</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://alessa0.cn/"/>
  <updated>2019-07-17T08:45:04.208Z</updated>
  <id>https://alessa0.cn/</id>
  
  <author>
    <name>Alessa0</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Flink电商团购项目（一）</title>
    <link href="https://alessa0.cn/posts/451f3483/"/>
    <id>https://alessa0.cn/posts/451f3483/</id>
    <published>2019-05-17T08:20:11.000Z</published>
    <updated>2019-07-17T08:45:04.208Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Wed Jul 17 2019 16:45:44 GMT+0800 (GMT+08:00) --><p class="description">Flink项目环境搭建</p><p><img src="https://image.alessa0.cn/090812.jpg" alt="daniel-chen-546446-unsplash"></p><a id="more"></a><blockquote class="blockquote-center"><p>第一章 大数据集群搭建</p></blockquote><div class="text-center"><a class="btn" href="https://flink.apache.org/" target="_blank" rel="noopener"><i class="fa fa-home fa-lg fa-fw"></i>Flink</a></div><h1 id="集群环境"><a href="#集群环境" class="headerlink" title="集群环境"></a>集群环境</h1><h3 id="系统"><a href="#系统" class="headerlink" title="系统"></a>系统</h3><p>CentOS-7-x86_64-Minimal-1810.iso</p><ul><li><strong>flink-master1</strong> 192.168.69.121 <strong>2core</strong> <strong>2G</strong></li><li><strong>flink-master2</strong> 192.168.69.122 <strong>2core</strong> <strong>2G</strong></li><li><strong>flink-slave1</strong> 192.168.69.123 <strong>1core</strong> <strong>2G</strong></li><li><strong>flink-slave2</strong> 192.168.69.124 <strong>1core</strong> <strong>2G</strong></li><li><strong>flink-slave3</strong> 192.168.69.125 <strong>1core</strong> <strong>2G</strong></li></ul><h3 id="Hadoop集群组件列表"><a href="#Hadoop集群组件列表" class="headerlink" title="Hadoop集群组件列表"></a>Hadoop集群组件列表</h3><table><thead><tr><th>组件</th><th style="text-align:center">Master1</th><th style="text-align:center">Master2</th><th style="text-align:center">Slave1</th><th style="text-align:center">Slave2</th><th style="text-align:center">Slave3</th></tr></thead><tbody><tr><td>jdk1.8.0_212</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td></tr><tr><td>scala-2.11.12</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td></tr><tr><td>miniconda3</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td></tr><tr><td>hadoop2.7.0</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td></tr><tr><td>kafka0.11</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td></tr><tr><td>mariadb/mariadb-server</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td>Hive2.2.0</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td>zookeeper 3.4.9</td><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td></tr><tr><td>Flume1.9</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td></tr><tr><td>Flink1.7</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td></tr></tbody></table><blockquote><p>组件安装步骤参考往期系列文章</p><p><a href="https://alessa0.cn/posts/aaa0d5f4/">Flink电商团购项目（零）</a></p><p><a href="https://alessa0.cn/categories/技术/大数据/环境搭建/">Hadoop环境搭建</a></p></blockquote><p><br></p><p><meting-js id="1338746736" server="netease" type="song" preload="none"><br></meting-js></p><hr><!-- rebuild by neat --><div><h1>推荐文章:</h1><ul><li><a href="https://alessa0.cn/posts/b7d573f0/">Hadoop 集群搭建(一)：节点配置</a></li><li><a href="https://alessa0.cn/posts/5578f504/">傻瓜式CDH集群部署指南</a></li><li><a href="https://blogs.kainy.cn/2013/06/通行证项目前端开发小结/">通行证项目前端开发小结</a></li><li><a href="https://blogs.kainy.cn/2013/04/拾贝电台开源了/">拾贝电台开源了</a></li></ul></div>]]></content>
    
    <summary type="html">
    
      &lt;!-- build time:Wed Jul 17 2019 16:45:44 GMT+0800 (GMT+08:00) --&gt;&lt;p class=&quot;description&quot;&gt;Flink项目环境搭建&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://image.alessa0.cn/090812.jpg&quot; alt=&quot;daniel-chen-546446-unsplash&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="技术" scheme="https://alessa0.cn/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="大数据" scheme="https://alessa0.cn/categories/%E6%8A%80%E6%9C%AF/%E5%A4%A7%E6%95%B0%E6%8D%AE/"/>
    
      <category term="项目实战" scheme="https://alessa0.cn/categories/%E6%8A%80%E6%9C%AF/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/"/>
    
      <category term="Flink电商团购" scheme="https://alessa0.cn/categories/%E6%8A%80%E6%9C%AF/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/Flink%E7%94%B5%E5%95%86%E5%9B%A2%E8%B4%AD/"/>
    
      <category term="01-大数据集群搭建" scheme="https://alessa0.cn/categories/%E6%8A%80%E6%9C%AF/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/Flink%E7%94%B5%E5%95%86%E5%9B%A2%E8%B4%AD/01-%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/"/>
    
    
      <category term="BigData" scheme="https://alessa0.cn/tags/BigData/"/>
    
      <category term="Flink" scheme="https://alessa0.cn/tags/Flink/"/>
    
      <category term="项目" scheme="https://alessa0.cn/tags/%E9%A1%B9%E7%9B%AE/"/>
    
      <category term="电商" scheme="https://alessa0.cn/tags/%E7%94%B5%E5%95%86/"/>
    
  </entry>
  
  <entry>
    <title>傻瓜式CDH集群部署指南</title>
    <link href="https://alessa0.cn/posts/5578f504/"/>
    <id>https://alessa0.cn/posts/5578f504/</id>
    <published>2019-05-17T06:40:59.000Z</published>
    <updated>2019-07-17T08:45:04.209Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Wed Jul 17 2019 16:45:44 GMT+0800 (GMT+08:00) --><p class="description">CDH环境配置</p><p><img src="https://image.alessa0.cn/074403.jpg" alt="clay-banks-1554989-unsplash"><a id="more"></a></p><blockquote class="blockquote-center"><p>单机内存最低8G</p></blockquote><div class="text-center"><a class="btn" href="https://www.cloudera.com/" target="_blank" rel="noopener"><i class="fa fa-home fa-lg fa-fw"></i>Cloudera</a></div><h1 id="集群环境"><a href="#集群环境" class="headerlink" title="集群环境"></a>集群环境</h1><h3 id="系统"><a href="#系统" class="headerlink" title="系统"></a>系统</h3><p>CentOS-7-x86_64-Minimal-1810.iso</p><ul><li><strong>cdh-master</strong> 192.168.69.111 <strong>4core</strong> <strong>16G</strong></li><li><strong>cdh-slave1</strong> 192.168.69.112 <strong>4core</strong> <strong>8G</strong></li><li><strong>cdh-slave2</strong> 192.168.69.113 <strong>4core</strong> <strong>8G</strong></li></ul><h1 id="关闭防火墙及修改hosts"><a href="#关闭防火墙及修改hosts" class="headerlink" title="关闭防火墙及修改hosts"></a>关闭防火墙及修改hosts</h1><h3 id="永久关闭内核防火墙："><a href="#永久关闭内核防火墙：" class="headerlink" title="永久关闭内核防火墙："></a>永久关闭内核防火墙：</h3><ul><li><code>vim /etc/selinux/config</code></li></ul><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改如下信息</span></span><br><span class="line"><span class="attr">SELINUX</span>=disabled</span><br></pre></td></tr></table></figure><h3 id="关闭系统防火墙："><a href="#关闭系统防火墙：" class="headerlink" title="关闭系统防火墙："></a>关闭系统防火墙：</h3><h5 id="停止firewall"><a href="#停止firewall" class="headerlink" title="停止firewall"></a>停止firewall</h5><ul><li><code>systemctl stop firewalld.service</code></li></ul><h5 id="禁止firewall开机启动"><a href="#禁止firewall开机启动" class="headerlink" title="禁止firewall开机启动"></a>禁止firewall开机启动</h5><ul><li><code>systemctl disable firewalld.service</code></li></ul><h3 id="修改hosts文件"><a href="#修改hosts文件" class="headerlink" title="修改hosts文件"></a>修改hosts文件</h3><ul><li><code>vim /etc/hosts</code></li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 添加如下信息</span><br><span class="line">192<span class="selector-class">.168</span><span class="selector-class">.69</span><span class="selector-class">.111</span> <span class="selector-tag">cdh-master</span> </span><br><span class="line">192<span class="selector-class">.168</span><span class="selector-class">.69</span><span class="selector-class">.112</span> <span class="selector-tag">cdh-slave1</span> </span><br><span class="line">192<span class="selector-class">.168</span><span class="selector-class">.69</span><span class="selector-class">.113</span> <span class="selector-tag">cdh-slave2</span></span><br></pre></td></tr></table></figure><h1 id="SSH互信"><a href="#SSH互信" class="headerlink" title="SSH互信"></a>SSH互信</h1><h3 id="生成密钥对（公钥和私钥）"><a href="#生成密钥对（公钥和私钥）" class="headerlink" title="生成密钥对（公钥和私钥）"></a>生成密钥对（公钥和私钥）</h3><ul><li><code>ssh-keygen -t rsa -P &#39;&#39;</code></li></ul><h3 id="追加authorized-keys"><a href="#追加authorized-keys" class="headerlink" title="追加authorized_keys"></a>追加authorized_keys</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 追加authorized_keys</span></span><br><span class="line">cat ~<span class="string">/.ssh/id_rsa.pub</span> &gt; ~<span class="string">/.ssh/authorized_keys</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改权限</span></span><br><span class="line">chmod g-w ~</span><br><span class="line">chmod 700 ~<span class="string">/.ssh</span> </span><br><span class="line">chmod 600 ~<span class="string">/.ssh/authorized_keys</span></span><br></pre></td></tr></table></figure><h3 id="追加密钥到Master"><a href="#追加密钥到Master" class="headerlink" title="追加密钥到Master"></a>追加密钥到Master</h3><ul><li><code>ssh cdh-slave1 cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</code></li><li><code>ssh cdh-slave2 cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</code></li></ul><h3 id="复制密钥到从节点"><a href="#复制密钥到从节点" class="headerlink" title="复制密钥到从节点"></a>复制密钥到从节点</h3><ul><li><code>scp ~/.ssh/authorized_keys cdh-slave1:~/.ssh/authorized_keys</code></li><li><code>scp ~/.ssh/authorized_keys cdh-slave2:~/.ssh/authorized_keys</code></li></ul><h1 id="ntp时间同步"><a href="#ntp时间同步" class="headerlink" title="ntp时间同步"></a>ntp时间同步</h1><h3 id="所有节点安装相关ntp组件"><a href="#所有节点安装相关ntp组件" class="headerlink" title="所有节点安装相关ntp组件"></a>所有节点安装相关ntp组件</h3><ul><li><code>yum -y install ntp</code></li></ul><h3 id="所有节点设置时区"><a href="#所有节点设置时区" class="headerlink" title="所有节点设置时区"></a>所有节点设置时区</h3><ul><li><code>timedatectl set-timezone Asia/Shanghai</code></li></ul><h3 id="启动ntp，以及设置开机启动"><a href="#启动ntp，以及设置开机启动" class="headerlink" title="启动ntp，以及设置开机启动"></a>启动ntp，以及设置开机启动</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动ntp</span></span><br><span class="line">systemctl start ntpd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置开机启动</span></span><br><span class="line">systemctl <span class="builtin-name">enable</span> ntpd</span><br></pre></td></tr></table></figure><h3 id="配置ntp服务器-master节点"><a href="#配置ntp服务器-master节点" class="headerlink" title="配置ntp服务器(master节点)"></a>配置ntp服务器(master节点)</h3><ul><li><code>vim /etc/ntp.conf</code></li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 修改如下几行</span><br><span class="line"><span class="selector-id">#server</span> 0<span class="selector-class">.centos</span><span class="selector-class">.pool</span><span class="selector-class">.ntp</span><span class="selector-class">.org</span> <span class="selector-tag">iburst</span></span><br><span class="line"><span class="selector-id">#server</span> 1<span class="selector-class">.centos</span><span class="selector-class">.pool</span><span class="selector-class">.ntp</span><span class="selector-class">.org</span> <span class="selector-tag">iburst</span></span><br><span class="line"><span class="selector-id">#server</span> 2<span class="selector-class">.centos</span><span class="selector-class">.pool</span><span class="selector-class">.ntp</span><span class="selector-class">.org</span> <span class="selector-tag">iburst</span></span><br><span class="line"><span class="selector-id">#server</span> 3<span class="selector-class">.centos</span><span class="selector-class">.pool</span><span class="selector-class">.ntp</span><span class="selector-class">.org</span> <span class="selector-tag">iburst</span></span><br><span class="line"></span><br><span class="line"># 添加如下几行</span><br><span class="line"><span class="selector-tag">restrict</span> 192<span class="selector-class">.168</span><span class="selector-class">.69</span><span class="selector-class">.2</span> <span class="selector-tag">mask</span> 255<span class="selector-class">.255</span><span class="selector-class">.255</span><span class="selector-class">.0</span> <span class="selector-tag">nomodify</span> <span class="selector-tag">notrap</span></span><br><span class="line"><span class="selector-tag">server</span> 127<span class="selector-class">.127</span><span class="selector-class">.1</span><span class="selector-class">.0</span></span><br><span class="line"><span class="selector-tag">fudge</span> 127<span class="selector-class">.127</span><span class="selector-class">.1</span><span class="selector-class">.0</span> <span class="selector-tag">stratum</span> 10</span><br></pre></td></tr></table></figure><h3 id="配置ntp服务器-slave节点"><a href="#配置ntp服务器-slave节点" class="headerlink" title="配置ntp服务器(slave节点)"></a>配置ntp服务器(slave节点)</h3><ul><li><code>vim /etc/ntp.conf</code></li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 修改如下几行</span><br><span class="line"><span class="selector-id">#server</span> 0<span class="selector-class">.centos</span><span class="selector-class">.pool</span><span class="selector-class">.ntp</span><span class="selector-class">.org</span> <span class="selector-tag">iburst</span></span><br><span class="line"><span class="selector-id">#server</span> 1<span class="selector-class">.centos</span><span class="selector-class">.pool</span><span class="selector-class">.ntp</span><span class="selector-class">.org</span> <span class="selector-tag">iburst</span></span><br><span class="line"><span class="selector-id">#server</span> 2<span class="selector-class">.centos</span><span class="selector-class">.pool</span><span class="selector-class">.ntp</span><span class="selector-class">.org</span> <span class="selector-tag">iburst</span></span><br><span class="line"><span class="selector-id">#server</span> 3<span class="selector-class">.centos</span><span class="selector-class">.pool</span><span class="selector-class">.ntp</span><span class="selector-class">.org</span> <span class="selector-tag">iburst</span></span><br><span class="line"></span><br><span class="line"># 添加如下几行(<span class="selector-tag">master</span>节点)</span><br><span class="line"><span class="selector-tag">restrict</span> 192<span class="selector-class">.168</span><span class="selector-class">.69</span><span class="selector-class">.2</span> <span class="selector-tag">mask</span> 255<span class="selector-class">.255</span><span class="selector-class">.255</span><span class="selector-class">.0</span> <span class="selector-tag">nomodify</span> <span class="selector-tag">notrap</span></span><br><span class="line"><span class="selector-tag">server</span> 192<span class="selector-class">.168</span><span class="selector-class">.69</span><span class="selector-class">.111</span></span><br></pre></td></tr></table></figure><h3 id="重启ntp服务"><a href="#重启ntp服务" class="headerlink" title="重启ntp服务"></a>重启ntp服务</h3><ul><li><code>systemctl restart ntpd</code></li></ul><h3 id="主节点定时服务"><a href="#主节点定时服务" class="headerlink" title="主节点定时服务"></a>主节点定时服务</h3><ul><li><code>crontab -e</code></li></ul><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span><span class="number">-59</span>/<span class="number">10</span> * * * * /usr/sbin/ntpdate -u asia.pool.ntp.org</span><br></pre></td></tr></table></figure><h3 id="手动同步master的时间"><a href="#手动同步master的时间" class="headerlink" title="手动同步master的时间"></a>手动同步master的时间</h3><ul><li><code>ntpdate -u 192.168.69.111</code></li></ul><h3 id="查看同步状态"><a href="#查看同步状态" class="headerlink" title="查看同步状态"></a>查看同步状态</h3><ul><li><code>ntpstat</code></li></ul><h1 id="配置Cloudera-rpm仓库"><a href="#配置Cloudera-rpm仓库" class="headerlink" title="配置Cloudera rpm仓库"></a>配置Cloudera rpm仓库</h1><h3 id="下载repo文件"><a href="#下载repo文件" class="headerlink" title="下载repo文件"></a>下载repo文件</h3><ul><li><code>sudo wget https://archive.cloudera.com/cm6/6.2.0/redhat7/yum/cloudera-manager.repo -P /etc/yum.repos.d/</code></li></ul><h3 id="使用GPG-key导入仓库"><a href="#使用GPG-key导入仓库" class="headerlink" title="使用GPG key导入仓库"></a>使用GPG key导入仓库</h3><ul><li><code>sudo rpm --import https://archive.cloudera.com/cm6/6.2.0/redhat7/yum/RPM-GPG-KEY-cloudera</code></li></ul><h3 id="下载parcel文件"><a href="#下载parcel文件" class="headerlink" title="下载parcel文件"></a>下载parcel文件</h3><ul><li><p><code>mkdir -p /opt/cloudera/parcel-repo/</code></p></li><li><p><code>sudo wget https://archive.cloudera.com/cdh6/6.2.0/parcels/CDH-6.2.0-1.cdh6.2.0.p0.967373-el7.parcel /opt/cloudera/parcel-repo/</code></p></li><li><code>sudo wget https://archive.cloudera.com/cdh6/6.2.0/parcels/CDH-6.2.0-1.cdh6.2.0.p0.967373-el7.parcel.sha256 /opt/cloudera/parcel-repo/</code></li><li><code>sudo wget https://archive.cloudera.com/cdh6/6.2.0/parcels/manifest.json /opt/cloudera/parcel-repo/</code></li></ul><h1 id="安装-Java（64-bit）"><a href="#安装-Java（64-bit）" class="headerlink" title="安装 Java（64-bit）"></a>安装 Java（64-bit）</h1><h3 id="卸载掉自带的-OpenJdk"><a href="#卸载掉自带的-OpenJdk" class="headerlink" title="卸载掉自带的 OpenJdk"></a>卸载掉自带的 OpenJdk</h3><ul><li><code>rpm -qa | grep java</code></li></ul><h3 id="使用Cloudera-Manager-安装-Java"><a href="#使用Cloudera-Manager-安装-Java" class="headerlink" title="使用Cloudera Manager 安装 Java"></a>使用Cloudera Manager 安装 Java</h3><ul><li><code>sudo yum -y install oracle-j2sdk1.8</code></li></ul><h3 id="设置环境变量"><a href="#设置环境变量" class="headerlink" title="设置环境变量"></a>设置环境变量</h3><ul><li><code>vim /etc/profile</code></li></ul><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># SET JAVA PATH </span></span><br><span class="line">export JAVA_HOME=<span class="regexp">/usr/java</span><span class="regexp">/jdk1.8.0_181-cloudera/</span></span><br><span class="line">export CLASSPATH=.:$<span class="symbol">CLASSPATH:</span>$JAVA_HOME/<span class="class"><span class="keyword">lib</span> </span></span><br><span class="line">export PATH=$<span class="symbol">PATH:</span>$JAVA_HOME/bin</span><br></pre></td></tr></table></figure><ul><li><code>source /etc/profile</code></li></ul><h5 id="yum-update报错Error-Delta-RPMs-disabled-because-usr-bin-applydeltarpm-not-installed"><a href="#yum-update报错Error-Delta-RPMs-disabled-because-usr-bin-applydeltarpm-not-installed" class="headerlink" title="yum update报错Error: Delta RPMs disabled because /usr/bin/applydeltarpm not installed."></a>yum update报错<code>Error: Delta RPMs disabled because /usr/bin/applydeltarpm not installed.</code></h5><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装deltarpm</span></span><br><span class="line"><span class="attribute">yum</span> provides <span class="string">'*/applydeltarpm'</span></span><br><span class="line">yum install deltarpm</span><br></pre></td></tr></table></figure><h1 id="安装Cloudera-Manager-Server"><a href="#安装Cloudera-Manager-Server" class="headerlink" title="安装Cloudera Manager Server"></a>安装Cloudera Manager Server</h1><h3 id="安装Cloudera-Manager包"><a href="#安装Cloudera-Manager包" class="headerlink" title="安装Cloudera Manager包"></a>安装Cloudera Manager包</h3><ul><li><code>sudo yum -y install cloudera-manager-daemons cloudera-manager-agent cloudera-manager-server</code></li></ul><p>Ps：可以在<a href="https://archive.cloudera.com/cm6/6.2.0/redhat7/yum/RPMS/x86_64/提前下好rpm包进行安装。" target="_blank" rel="noopener">https://archive.cloudera.com/cm6/6.2.0/redhat7/yum/RPMS/x86_64/提前下好rpm包进行安装。</a></p><h3 id="启用Auto-TLS"><a href="#启用Auto-TLS" class="headerlink" title="启用Auto-TLS"></a>启用Auto-TLS</h3><p>待续</p><h1 id="安装和配置数据库MariaDB-for-Cloudera-Software-master节点"><a href="#安装和配置数据库MariaDB-for-Cloudera-Software-master节点" class="headerlink" title="安装和配置数据库MariaDB for Cloudera Software(master节点)"></a>安装和配置数据库MariaDB for Cloudera Software(master节点)</h1><h3 id="安装MariaDB"><a href="#安装MariaDB" class="headerlink" title="安装MariaDB"></a>安装MariaDB</h3><ul><li><code>sudo yum -y install mariadb-server</code></li></ul><h3 id="配置MariaDB"><a href="#配置MariaDB" class="headerlink" title="配置MariaDB"></a>配置MariaDB</h3><ul><li><code>vim /etc/my.cnf</code></li></ul><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">datadir=/var/lib/mysql</span><br><span class="line">socket=/var/lib/mysql/mysql.sock</span><br><span class="line">transaction-isolation = READ-COMMITTED</span><br><span class="line"><span class="comment"># Disabling symbolic-links is recommended to prevent assorted security risks;</span></span><br><span class="line"><span class="comment"># to do so, uncomment this line:</span></span><br><span class="line">symbolic-links = 0</span><br><span class="line"><span class="comment"># Settings user and group are ignored when systemd is used.</span></span><br><span class="line"><span class="comment"># If you need to run mysqld under a different user or group,</span></span><br><span class="line"><span class="comment"># customize your systemd unit file for mariadb according to the</span></span><br><span class="line"><span class="comment"># instructions in http://fedoraproject.org/wiki/Systemd</span></span><br><span class="line"></span><br><span class="line">key_buffer = 16M</span><br><span class="line">key_buffer_size = 32M</span><br><span class="line">max_allowed_packet = 32M</span><br><span class="line">thread_stack = 256K</span><br><span class="line">thread_cache_size = 64</span><br><span class="line">query_cache_limit = 8M</span><br><span class="line">query_cache_size = 64M</span><br><span class="line">query_cache_type = 1</span><br><span class="line"></span><br><span class="line">max_connections = 550</span><br><span class="line"><span class="comment">#expire_logs_days = 10</span></span><br><span class="line"><span class="comment">#max_binlog_size = 100M</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#log_bin should be on a disk with enough free space.</span></span><br><span class="line"><span class="comment">#Replace '/var/lib/mysql/mysql_binary_log' with an appropriate path for your</span></span><br><span class="line"><span class="comment">#system and chown the specified folder to the mysql user.</span></span><br><span class="line">log_bin=/var/lib/mysql/mysql_binary_log</span><br><span class="line"></span><br><span class="line"><span class="comment">#In later versions of MariaDB, if you enable the binary log and do not set</span></span><br><span class="line"><span class="comment">#a server_id, MariaDB will not start. The server_id must be unique within</span></span><br><span class="line"><span class="comment">#the replicating group.</span></span><br><span class="line">server_id=1</span><br><span class="line"></span><br><span class="line">binlog_format = mixed</span><br><span class="line"></span><br><span class="line">read_buffer_size = 2M</span><br><span class="line">read_rnd_buffer_size = 16M</span><br><span class="line">sort_buffer_size = 8M</span><br><span class="line">join_buffer_size = 8M</span><br><span class="line"></span><br><span class="line"><span class="comment"># InnoDB settings</span></span><br><span class="line">innodb_file_per_table = 1</span><br><span class="line">innodb_flush_log_at_trx_commit  = 2</span><br><span class="line">innodb_log_buffer_size = 64M</span><br><span class="line">innodb_buffer_pool_size = 4G</span><br><span class="line">innodb_thread_concurrency = 8</span><br><span class="line">innodb_flush_method = O_DIRECT</span><br><span class="line">innodb_log_file_size = 512M</span><br><span class="line"></span><br><span class="line">[mysqld_safe]</span><br><span class="line">log-error=/var/log/mariadb/mariadb.log</span><br><span class="line">pid-file=/var/run/mariadb/mariadb.pid</span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># include all files from the config directory</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">!includedir /etc/my.cnf.d</span><br></pre></td></tr></table></figure><h3 id="启动MariaDB"><a href="#启动MariaDB" class="headerlink" title="启动MariaDB"></a>启动MariaDB</h3><h5 id="开机启动MariaDB"><a href="#开机启动MariaDB" class="headerlink" title="开机启动MariaDB"></a>开机启动MariaDB</h5><ul><li><code>sudo systemctl enable mariadb</code></li></ul><h5 id="启动MariaDB服务"><a href="#启动MariaDB服务" class="headerlink" title="启动MariaDB服务"></a>启动MariaDB服务</h5><ul><li><code>sudo systemctl start mariadb</code></li></ul><h3 id="安全设置"><a href="#安全设置" class="headerlink" title="安全设置"></a>安全设置</h3><ul><li><code>sudo /usr/bin/mysql_secure_installation</code></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[...]</span><br><span class="line">Enter current password for root (enter for none):</span><br><span class="line">OK, successfully used password, moving on...</span><br><span class="line">[...]</span><br><span class="line"><span class="keyword">Set</span> root <span class="keyword">password</span>? [Y/n] Y</span><br><span class="line"><span class="keyword">New</span> <span class="keyword">password</span>: <span class="number">123</span></span><br><span class="line">Re-enter <span class="keyword">new</span> <span class="keyword">password</span>: <span class="number">123</span></span><br><span class="line">[...]</span><br><span class="line">Remove anonymous <span class="keyword">users</span>? [Y/n] Y</span><br><span class="line">[...]</span><br><span class="line"><span class="keyword">Disallow</span> root login remotely? [Y/n] Y</span><br><span class="line">[...]</span><br><span class="line">Remove <span class="keyword">test</span> <span class="keyword">database</span> <span class="keyword">and</span> <span class="keyword">access</span> <span class="keyword">to</span> it [Y/n] Y</span><br><span class="line">[...]</span><br><span class="line">Reload privilege <span class="keyword">tables</span> <span class="keyword">now</span>? [Y/n] Y</span><br><span class="line">[...]</span><br><span class="line"><span class="keyword">All</span> done!  <span class="keyword">If</span> you<span class="string">'ve completed all of the above steps, your MariaDB</span></span><br><span class="line"><span class="string">installation should now be secure.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Thanks for using MariaDB!</span></span><br></pre></td></tr></table></figure><h3 id="安装MySQL-JDBC-Driver-for-MariaDB"><a href="#安装MySQL-JDBC-Driver-for-MariaDB" class="headerlink" title="安装MySQL JDBC Driver for MariaDB"></a>安装MySQL JDBC Driver for MariaDB</h3><h5 id="下载驱动包"><a href="#下载驱动包" class="headerlink" title="下载驱动包"></a>下载驱动包</h5><ul><li><code>wget https://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-5.1.46.tar.gz</code></li></ul><h5 id="解压驱动包"><a href="#解压驱动包" class="headerlink" title="解压驱动包"></a>解压驱动包</h5><ul><li><code>tar zxvf mysql-connector-java-5.1.46.tar.gz</code></li><li><code>rm -rf mysql-connector-java-5.1.46.tar.gz</code></li></ul><h5 id="复制驱动包"><a href="#复制驱动包" class="headerlink" title="复制驱动包"></a>复制驱动包</h5><ul><li><code>sudo mkdir -p /usr/share/java/</code></li><li><code>cd mysql-connector-java-5.1.46</code></li><li><code>sudo cp mysql-connector-java-5.1.46-bin.jar /usr/share/java/mysql-connector-java.jar</code></li></ul><h3 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h3><h5 id="登录root账户"><a href="#登录root账户" class="headerlink" title="登录root账户"></a>登录root账户</h5><ul><li><code>mysql -uroot -p</code></li></ul><h5 id="创建hive数据库"><a href="#创建hive数据库" class="headerlink" title="创建hive数据库"></a>创建hive数据库</h5><ul><li><code>CREATE DATABASE metastore DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;</code></li><li><code>CREATE DATABASE scm DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;</code></li><li><code>CREATE DATABASE oozie DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;</code></li><li><code>CREATE DATABASE hue DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;</code></li></ul><h5 id="创建账户"><a href="#创建账户" class="headerlink" title="创建账户"></a>创建账户</h5><ul><li><code>GRANT ALL ON metastore.* TO &#39;hive&#39;@&#39;%&#39; IDENTIFIED BY &#39;123&#39;;</code></li><li><code>GRANT ALL ON scm.* TO &#39;scm&#39;@&#39;%&#39; IDENTIFIED BY &#39;123&#39;;</code></li><li><code>GRANT ALL ON oozie.* TO &#39;oozie&#39;@&#39;%&#39; IDENTIFIED BY &#39;123&#39;;</code></li><li><code>GRANT ALL ON hue.* TO &#39;hue&#39;@&#39;%&#39; IDENTIFIED BY &#39;123&#39;;</code></li></ul><h5 id="刷新权限"><a href="#刷新权限" class="headerlink" title="刷新权限"></a>刷新权限</h5><ul><li><code>flush privileges;</code></li></ul><h5 id="查看数据库"><a href="#查看数据库" class="headerlink" title="查看数据库"></a>查看数据库</h5><ul><li><code>SHOW DATABASES;</code></li></ul><h5 id="查看权限"><a href="#查看权限" class="headerlink" title="查看权限"></a>查看权限</h5><ul><li><code>SHOW GRANTS FOR &#39;hive&#39;@&#39;%&#39;;</code></li></ul><h1 id="设置Cloudera-Manager数据库-master节点"><a href="#设置Cloudera-Manager数据库-master节点" class="headerlink" title="设置Cloudera Manager数据库(master节点)"></a>设置Cloudera Manager数据库(master节点)</h1><h3 id="设置语法"><a href="#设置语法" class="headerlink" title="设置语法"></a>设置语法</h3><ul><li><code>sudo /opt/cloudera/cm/schema/scm_prepare_database.sh mysql scm scm 123</code></li></ul><h3 id="准备数据库"><a href="#准备数据库" class="headerlink" title="准备数据库"></a>准备数据库</h3><ul><li><code>sudo /opt/cloudera/cm/schema/scm_prepare_database.sh mysql scm scm</code></li></ul><h1 id="安装CDH及其他软件"><a href="#安装CDH及其他软件" class="headerlink" title="安装CDH及其他软件"></a>安装CDH及其他软件</h1><h3 id="强烈建议-所有节点拍摄快照"><a href="#强烈建议-所有节点拍摄快照" class="headerlink" title="[强烈建议]所有节点拍摄快照"></a>[强烈建议]所有节点拍摄快照</h3><h3 id="启动Cloudera-Manager-Server-master节点"><a href="#启动Cloudera-Manager-Server-master节点" class="headerlink" title="启动Cloudera Manager Server(master节点)"></a>启动Cloudera Manager Server(master节点)</h3><ul><li><code>sudo systemctl start cloudera-scm-server</code></li></ul><h3 id="查看日志-master节点"><a href="#查看日志-master节点" class="headerlink" title="查看日志(master节点)"></a>查看日志(master节点)</h3><ul><li><code>sudo tail -f /var/log/cloudera-scm-server/cloudera-scm-server.log</code></li></ul><p>直至出现<code>INFO WebServerImpl:com.cloudera.server.cmf.WebServerImpl: Started Jetty server.</code></p><h3 id="登录web页面"><a href="#登录web页面" class="headerlink" title="登录web页面"></a>登录web页面</h3><ul><li><code>http://cdh-master:7180</code></li></ul><p>账户：admin</p><p>密码：admin</p><h3 id="安装组件"><a href="#安装组件" class="headerlink" title="安装组件"></a>安装组件</h3><h5 id="接受最终用户许可条款和条件"><a href="#接受最终用户许可条款和条件" class="headerlink" title="接受最终用户许可条款和条件"></a>接受最终用户许可条款和条件</h5><h5 id="选择Cloudera-Express免费版"><a href="#选择Cloudera-Express免费版" class="headerlink" title="选择Cloudera Express免费版"></a>选择Cloudera Express免费版</h5><h5 id="集群安装"><a href="#集群安装" class="headerlink" title="集群安装"></a>集群安装</h5><h6 id="Cluster-Basics"><a href="#Cluster-Basics" class="headerlink" title="Cluster Basics"></a>Cluster Basics</h6><ul><li><code>CDH</code></li></ul><h6 id="Specify-Hosts"><a href="#Specify-Hosts" class="headerlink" title="Specify Hosts"></a>Specify Hosts</h6><ul><li>输入<code>cdh-master, cdh-slave1, cdh-slave2</code>点击’搜索’</li></ul><h6 id="选择存储库"><a href="#选择存储库" class="headerlink" title="选择存储库"></a>选择存储库</h6><ul><li>选择<code>Public Cloudera Repository</code></li><li>选择<code>Parcels</code></li><li>其他默认</li></ul><h6 id="JDK-安装选项"><a href="#JDK-安装选项" class="headerlink" title="JDK 安装选项"></a>JDK 安装选项</h6><ul><li>选中<code>安装 Oracle Java SE 开发工具包 (JDK)</code></li></ul><h6 id="设置登录凭据"><a href="#设置登录凭据" class="headerlink" title="设置登录凭据"></a>设置登录凭据</h6><ul><li>选择<code>root</code></li><li>输入密码</li></ul><h6 id="安装agents"><a href="#安装agents" class="headerlink" title="安装agents"></a>安装agents</h6><h6 id="安装Parcels"><a href="#安装Parcels" class="headerlink" title="安装Parcels"></a>安装Parcels</h6><h6 id="Inspect-Hosts"><a href="#Inspect-Hosts" class="headerlink" title="Inspect Hosts"></a>Inspect Hosts</h6><ul><li><p>虚拟内存设置</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sysctl -<span class="keyword">w</span> <span class="keyword">vm</span>.swappiness=<span class="number">10</span></span><br><span class="line"><span class="keyword">echo</span> <span class="keyword">vm</span>.swappiness = <span class="number">10</span> &gt;&gt; /etc/sysctl.<span class="keyword">conf</span></span><br></pre></td></tr></table></figure></li><li><p>大内存页设置</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 临时</span></span><br><span class="line">echo never&gt;<span class="meta-keyword">/sys/</span>kernel<span class="meta-keyword">/mm/</span>transparent_hugepage/defrag</span><br><span class="line">echo never&gt;<span class="meta-keyword">/sys/</span>kernel<span class="meta-keyword">/mm/</span>transparent_hugepage/enabled</span><br><span class="line"></span><br><span class="line"><span class="meta"># 永久</span></span><br><span class="line">vim <span class="meta-keyword">/etc/</span>rc.local</span><br><span class="line"><span class="meta"># 加入如下信息</span></span><br><span class="line">echo never&gt;<span class="meta-keyword">/sys/</span>kernel<span class="meta-keyword">/mm/</span>transparent_hugepage/defrag</span><br><span class="line">echo never&gt;<span class="meta-keyword">/sys/</span>kernel<span class="meta-keyword">/mm/</span>transparent_hugepage/enabled</span><br><span class="line"><span class="meta"># 设置权限</span></span><br><span class="line">chmod +x <span class="meta-keyword">/etc/</span>rc.d/rc.local</span><br></pre></td></tr></table></figure></li></ul><h6 id="组件列表"><a href="#组件列表" class="headerlink" title="组件列表"></a>组件列表</h6><table><thead><tr><th style="text-align:left">组件</th><th style="text-align:left">版本</th></tr></thead><tbody><tr><td style="text-align:left">Supervisord</td><td style="text-align:left">3.0</td></tr><tr><td style="text-align:left">Cloudera Manager Agent</td><td style="text-align:left">6.2.0</td></tr><tr><td style="text-align:left">Cloudera Manager Management Daemon</td><td style="text-align:left">6.2.0</td></tr><tr><td style="text-align:left">Flume NG</td><td style="text-align:left">1.9.0+cdh6.2.0</td></tr><tr><td style="text-align:left">Hadoop</td><td style="text-align:left">3.0.0+cdh6.2.0</td></tr><tr><td style="text-align:left">HDFS</td><td style="text-align:left">3.0.0+cdh6.2.0</td></tr><tr><td style="text-align:left">HttpFS</td><td style="text-align:left">3.0.0+cdh6.2.0</td></tr><tr><td style="text-align:left">hadoop-kms</td><td style="text-align:left">3.0.0+cdh6.2.0</td></tr><tr><td style="text-align:left">MapReduce 2</td><td style="text-align:left">3.0.0+cdh6.2.0</td></tr><tr><td style="text-align:left">YARN</td><td style="text-align:left">3.0.0+cdh6.2.0</td></tr><tr><td style="text-align:left">HBase</td><td style="text-align:left">2.1.0+cdh6.2.0</td></tr><tr><td style="text-align:left">Lily HBase Indexer</td><td style="text-align:left">1.5+cdh6.2.0</td></tr><tr><td style="text-align:left">Hive</td><td style="text-align:left">2.1.1+cdh6.2.0</td></tr><tr><td style="text-align:left">HCatalog</td><td style="text-align:left">2.1.1+cdh6.2.0</td></tr><tr><td style="text-align:left">Hue</td><td style="text-align:left">4.2.0+cdh6.2.0</td></tr><tr><td style="text-align:left">Impala</td><td style="text-align:left">3.2.0+cdh6.2.0</td></tr><tr><td style="text-align:left">Java 8</td><td style="text-align:left">1.8.0_181</td></tr><tr><td style="text-align:left">Kafka</td><td style="text-align:left">2.1.0+cdh6.2.0</td></tr><tr><td style="text-align:left">Kite（仅限 CDH 5 ）</td><td style="text-align:left">1.0.0+cdh6.2.0</td></tr><tr><td style="text-align:left">kudu</td><td style="text-align:left">1.9.0+cdh6.2.0</td></tr><tr><td style="text-align:left">Oozie</td><td style="text-align:left">5.1.0+cdh6.2.0</td></tr><tr><td style="text-align:left">Parquet</td><td style="text-align:left">1.9.0+cdh6.2.0</td></tr><tr><td style="text-align:left">Pig</td><td style="text-align:left">0.17.0+cdh6.2.0</td></tr><tr><td style="text-align:left">sentry</td><td style="text-align:left">2.1.0+cdh6.2.0</td></tr><tr><td style="text-align:left">Solr</td><td style="text-align:left">7.4.0+cdh6.2.0</td></tr><tr><td style="text-align:left">spark</td><td style="text-align:left">2.4.0+cdh6.2.0</td></tr><tr><td style="text-align:left">Sqoop</td><td style="text-align:left">1.4.7+cdh6.2.0</td></tr><tr><td style="text-align:left">ZooKeeper</td><td style="text-align:left">3.4.5+cdh6.2.0</td></tr></tbody></table><h1 id="使用向导设置群集"><a href="#使用向导设置群集" class="headerlink" title="使用向导设置群集"></a>使用向导设置群集</h1><h3 id="选择服务"><a href="#选择服务" class="headerlink" title="选择服务"></a>选择服务</h3><ul><li>选择<code>所有服务</code></li><li><del>选择<code>HBase</code> <code>HDFS</code> <code>Hive</code> <code>Hue</code> <code>Kafka</code> <code>Oozie</code> <code>YARN(MR2 Included)</code> <code>ZooKeeper</code></del></li></ul><h3 id="自定义角色分配"><a href="#自定义角色分配" class="headerlink" title="自定义角色分配"></a>自定义角色分配</h3><ul><li>默认</li></ul><h3 id="数据库设置"><a href="#数据库设置" class="headerlink" title="数据库设置"></a>数据库设置</h3><h5 id="Hive"><a href="#Hive" class="headerlink" title="Hive"></a>Hive</h5><ul><li><code>MySQL &gt; 否 &gt; cdh-master &gt; metastore &gt; hive &gt; 123</code></li></ul><h5 id="Oozie"><a href="#Oozie" class="headerlink" title="Oozie"></a>Oozie</h5><ul><li><code>MySQL &gt; cdh-master &gt; oozie &gt; oozie &gt; 123</code></li></ul><h5 id="Hue"><a href="#Hue" class="headerlink" title="Hue"></a>Hue</h5><ul><li><code>MySQL &gt; cdh-master &gt; hue &gt; hue &gt; 123</code></li></ul><h3 id="审核更改"><a href="#审核更改" class="headerlink" title="审核更改"></a>审核更改</h3><ul><li>默认</li></ul><h3 id="命令详细信息"><a href="#命令详细信息" class="headerlink" title="命令详细信息"></a>命令详细信息</h3><p>Ps：若搭建过程中多次尝试安装，建议删除/dfs/nn下文件，避免HDFS服务报错</p><h3 id="汇总"><a href="#汇总" class="headerlink" title="汇总"></a>汇总</h3><h1 id="错误排查"><a href="#错误排查" class="headerlink" title="错误排查"></a>错误排查</h1><p>推荐链接 &gt;&gt; <a href="https://blog.csdn.net/zzq900503/article/details/53393721" target="_blank" rel="noopener">https://blog.csdn.net/zzq900503/article/details/53393721</a></p><p><br></p><p><meting-js id="31654478" server="netease" type="song" preload="none"><br></meting-js></p><hr><!-- rebuild by neat --><div><h1>推荐文章:</h1><ul><li><a href="https://alessa0.cn/posts/451f3483/">Flink电商团购项目（一）</a></li><li><a href="https://alessa0.cn/posts/b7d573f0/">Hadoop 集群搭建(一)：节点配置</a></li></ul></div>]]></content>
    
    <summary type="html">
    
      &lt;!-- build time:Wed Jul 17 2019 16:45:44 GMT+0800 (GMT+08:00) --&gt;&lt;p class=&quot;description&quot;&gt;CDH环境配置&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://image.alessa0.cn/074403.jpg&quot; alt=&quot;clay-banks-1554989-unsplash&quot;&gt;
    
    </summary>
    
      <category term="技术" scheme="https://alessa0.cn/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="大数据" scheme="https://alessa0.cn/categories/%E6%8A%80%E6%9C%AF/%E5%A4%A7%E6%95%B0%E6%8D%AE/"/>
    
      <category term="CDH" scheme="https://alessa0.cn/categories/%E6%8A%80%E6%9C%AF/%E5%A4%A7%E6%95%B0%E6%8D%AE/CDH/"/>
    
    
      <category term="BigData" scheme="https://alessa0.cn/tags/BigData/"/>
    
      <category term="CDH环境搭建" scheme="https://alessa0.cn/tags/CDH%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    
  </entry>
  
  <entry>
    <title>Hadoop 集群搭建(一)：节点配置</title>
    <link href="https://alessa0.cn/posts/b7d573f0/"/>
    <id>https://alessa0.cn/posts/b7d573f0/</id>
    <published>2019-04-24T09:30:50.000Z</published>
    <updated>2019-07-17T08:44:56.024Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Wed Jul 17 2019 16:45:44 GMT+0800 (GMT+08:00) --><p></p><p class="description">虚拟机节点配置</p><br><img src="https://image.alessa0.cn/131223.jpg" alt="arian-darvishi-1210156-unsplash"><p></p><a id="more"></a><blockquote class="blockquote-center"><p>Hello, BigData</p></blockquote><h1 id="集群环境"><a href="#集群环境" class="headerlink" title="集群环境"></a>集群环境</h1><p><strong>系统：</strong></p><p>CentOS-7-x86_64-Minimal-1810.iso</p><ul><li><p><strong>Master</strong> 192.168.69.101</p></li><li><p><strong>Slave1</strong> 192.168.69.102</p></li><li><p><strong>Slave2</strong> 192.168.69.103</p></li></ul><p><strong>修改IP地址：</strong></p><ul><li><code>vim /etc/sysconfig/network-scripts/ifcfg-ens33</code></li></ul><span class="label danger">Master</span><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 修改如下信息</span><br><span class="line">IPADDR=<span class="number">192.168</span><span class="number">.69</span><span class="number">.101</span> </span><br><span class="line">NETMASK=<span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span> </span><br><span class="line">GATEWAY=<span class="number">192.168</span><span class="number">.69</span><span class="number">.2</span> </span><br><span class="line">DNS1=<span class="number">119.29</span><span class="number">.29</span><span class="number">.29</span></span><br></pre></td></tr></table></figure><span class="label danger">仅在Slave1</span><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 修改如下信息</span><br><span class="line">IPADDR=<span class="number">192.168</span><span class="number">.69</span><span class="number">.102</span> </span><br><span class="line">NETMASK=<span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span> </span><br><span class="line">GATEWAY=<span class="number">192.168</span><span class="number">.69</span><span class="number">.2</span> </span><br><span class="line">DNS1=<span class="number">119.29</span><span class="number">.29</span><span class="number">.29</span></span><br></pre></td></tr></table></figure><span class="label danger">仅在Slave2</span><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 修改如下信息</span><br><span class="line">IPADDR=<span class="number">192.168</span><span class="number">.69</span><span class="number">.103</span> </span><br><span class="line">NETMASK=<span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span> </span><br><span class="line">GATEWAY=<span class="number">192.168</span><span class="number">.69</span><span class="number">.2</span> </span><br><span class="line">DNS1=<span class="number">119.29</span><span class="number">.29</span><span class="number">.29</span></span><br></pre></td></tr></table></figure><h1 id="关闭系统防火墙及内核防火墙"><a href="#关闭系统防火墙及内核防火墙" class="headerlink" title="关闭系统防火墙及内核防火墙"></a>关闭系统防火墙及内核防火墙</h1><p><strong>永久关闭内核防火墙：</strong></p><ul><li><p><code>yum -y install vim</code></p></li><li><p><code>vim /etc/selinux/config</code></p></li></ul><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改如下信息</span></span><br><span class="line"><span class="attr">SELINUX</span>=disabled</span><br></pre></td></tr></table></figure><p><strong>停止firewall：</strong></p><ul><li><code>systemctl stop firewalld.service</code></li></ul><p><strong>禁止firewall开机启动：</strong></p><ul><li><code>systemctl disable firewalld.service</code></li></ul><h1 id="修改主机文件"><a href="#修改主机文件" class="headerlink" title="修改主机文件"></a>修改主机文件</h1><p><strong>修改主机名：</strong></p><span class="label danger">仅在Master</span><ul><li><code>hostnamectl set-hostname master</code></li></ul><span class="label danger">仅在Slave1</span><ul><li><code>hostnamectl set-hostname slave1</code></li></ul><span class="label danger">仅在Slave2</span><ul><li><code>hostnamectl set-hostname slave2</code></li></ul><p><strong>修改hosts文件：</strong></p><ul><li><code>vim /etc/hosts</code></li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 添加如下信息</span><br><span class="line">192<span class="selector-class">.168</span><span class="selector-class">.69</span><span class="selector-class">.101</span> <span class="selector-tag">master</span> </span><br><span class="line">192<span class="selector-class">.168</span><span class="selector-class">.69</span><span class="selector-class">.102</span> <span class="selector-tag">slave1</span> </span><br><span class="line">192<span class="selector-class">.168</span><span class="selector-class">.69</span><span class="selector-class">.103</span> <span class="selector-tag">slave2</span> </span><br><span class="line"># 本地(可不加)</span><br><span class="line">192<span class="selector-class">.168</span><span class="selector-class">.69</span><span class="selector-class">.1</span> <span class="selector-tag">client</span></span><br></pre></td></tr></table></figure><h1 id="SSH互信配置"><a href="#SSH互信配置" class="headerlink" title="SSH互信配置"></a>SSH互信配置</h1><p><strong>生成密钥对（公钥和私钥）–三次回车生成密钥：</strong></p><ul><li><code>ssh-keygen -t rsa -P &#39;&#39;</code></li></ul><p><strong>追加：</strong></p><ul><li><p><code>cat ~/.ssh/id_rsa.pub &gt; ~/.ssh/authorized_keys</code></p></li><li><p><code>chmod g-w ~</code></p></li><li><p><code>chmod 700 ~/.ssh</code></p></li><li><p><code>chmod 600 ~/.ssh/authorized_keys</code></p></li></ul><p><strong>追加密钥到Master：</strong></p><ul><li><code>ssh [ 主机名 ] cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</code></li></ul><p><strong>复制密钥到从节点：</strong></p><ul><li><code>scp ~/.ssh/authorized_keys [ 主机名 ]:~/.ssh/authorized_keys</code></li></ul><h1 id="设置vmware共享文件夹"><a href="#设置vmware共享文件夹" class="headerlink" title="设置vmware共享文件夹"></a>设置vmware共享文件夹</h1><p>cd /mnt/hgfs/ 发现没有文件，解决如下</p><p><strong>安装工具：</strong></p><ul><li><code>yum -y install open-vm-tools gcc gcc-c++ automake make kernel-devel git</code></li></ul><p><strong>终端中输入如下命令：</strong></p><ul><li><p><code>git clone https://github.com/rasa/vmware-tools-patches.git</code></p></li><li><p><code>cd vmware-tools-patches</code></p></li><li><p><code></code>./patched-open-vm-tools.sh`</p></li></ul><p><strong>查看分享目录：</strong></p><ul><li><p><code>vmware-hgfsclient</code></p></li><li><p><code>su</code></p></li></ul><p><strong>临时挂载分享目录：</strong></p><ul><li><code>mount.vmhgfs .host:/ /mnt/hgfs/</code></li></ul><p><strong>永久挂载分享目录：</strong></p><ul><li><code>vmware-config-tools.pl -d --clobber-kernel-modules=vmhgfs</code></li></ul><p><strong>#使用如下方法挂载有的会出错：</strong></p><ul><li><code>vim /etc/fstab</code></li></ul><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 末尾添加如下信息</span></span><br><span class="line"><span class="string">.host</span>:/ <span class="string">/mnt/hgfs</span> fuse.vmhgfs-fuse allow_other 0 0</span><br></pre></td></tr></table></figure><p><strong>删除工具包</strong></p><ul><li><p><code>cd ~</code></p></li><li><p><code>rm -rf ~/vmware-tools-patches</code></p></li><li><p><code>reboot</code></p></li></ul><h1 id="修改src权限"><a href="#修改src权限" class="headerlink" title="修改src权限"></a>修改src权限</h1><ul><li><p><code>cd /usr/local</code></p></li><li><p><code>sudo chown -R alessa0:alessa0 src</code></p></li><li><p><code>sudo chown -R alessa0:alessa0 bin</code></p></li></ul><p><strong>更改源为阿里云：</strong></p><ul><li><code>cd /etc/yum.repos.d/</code></li><li><code>mv CentOS-Base.repo CentOS-Base.repo.bak</code></li><li><code>wget http://mirrors.aliyun.com/repo/Centos-7.repo</code></li><li><code>wget http://mirrors.163.com/.help/CentOS7-Base-163.repo</code></li><li><code>yum clean all</code></li><li><code>yum makecache</code></li></ul><p><strong>安装网络工具包和基础工具包：</strong></p><ul><li><code>sudo yum -y install net-tools checkpolicy gcc dkms foomatic openssh-server bash-completion psmisc</code></li></ul><h1 id="Hadoop集群组件列表"><a href="#Hadoop集群组件列表" class="headerlink" title="Hadoop集群组件列表"></a>Hadoop集群组件列表</h1><table><thead><tr><th>组件</th><th style="text-align:center">master</th><th style="text-align:center">slave1</th><th style="text-align:center">slave2</th></tr></thead><tbody><tr><td>jdk1.8.0_212</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td></tr><tr><td>miniconda3</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td></tr><tr><td>scala-2.11.12</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td></tr><tr><td>hadoop-2.8.5</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td></tr><tr><td>redis-5.0.4</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td>zookeeper-3.4.14</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td></tr><tr><td>spark-2.3.3-bin-hadoop2.7</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td></tr><tr><td>mariadb/mariadb-server</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td>apache-hive-2.3.4-bin</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td>hbase-1.3.3</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td></tr><tr><td>thrift-0.12.0</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td>apache-flume-1.9.0-bin</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td></tr><tr><td>kafka_2.11-2.2.0</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td></tr><tr><td>apache-storm-1.2.2</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td></tr><tr><td>Storm-on-Yarn</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td>flink-1.8.0</td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td><td style="text-align:center"><strong>√</strong></td></tr></tbody></table><p><br></p><p><meting-js id="1325896374" server="netease" type="song" preload="none"><br></meting-js></p><hr><!-- rebuild by neat --><div><h1>推荐文章:</h1><ul><li><a href="https://alessa0.cn/posts/451f3483/">Flink电商团购项目（一）</a></li><li><a href="https://alessa0.cn/posts/5578f504/">傻瓜式CDH集群部署指南</a></li></ul></div>]]></content>
    
    <summary type="html">
    
      &lt;!-- build time:Wed Jul 17 2019 16:45:44 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;&lt;/p&gt;&lt;p class=&quot;description&quot;&gt;虚拟机节点配置&lt;/p&gt;&lt;br&gt;&lt;img src=&quot;https://image.alessa0.cn/131223.jpg&quot; alt=&quot;arian-darvishi-1210156-unsplash&quot;&gt;&lt;p&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="技术" scheme="https://alessa0.cn/categories/%E6%8A%80%E6%9C%AF/"/>
    
      <category term="大数据" scheme="https://alessa0.cn/categories/%E6%8A%80%E6%9C%AF/%E5%A4%A7%E6%95%B0%E6%8D%AE/"/>
    
      <category term="环境搭建" scheme="https://alessa0.cn/categories/%E6%8A%80%E6%9C%AF/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    
      <category term="CentOS 7" scheme="https://alessa0.cn/categories/%E6%8A%80%E6%9C%AF/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/CentOS-7/"/>
    
    
      <category term="BigData" scheme="https://alessa0.cn/tags/BigData/"/>
    
      <category term="Hadoop环境搭建" scheme="https://alessa0.cn/tags/Hadoop%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    
      <category term="Vmware" scheme="https://alessa0.cn/tags/Vmware/"/>
    
  </entry>
  
</feed>
